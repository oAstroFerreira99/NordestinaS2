-----------------------------------------------------------------------------------------------------------------------------------------
-- VRP
-----------------------------------------------------------------------------------------------------------------------------------------
local Tunnel = module("vrp","lib/Tunnel")
local Proxy = module("vrp","lib/Proxy")
vRP = Proxy.getInterface("vRP")
-----------------------------------------------------------------------------------------------------------------------------------------
-- CONNECTION
-----------------------------------------------------------------------------------------------------------------------------------------
vSERVER = Tunnel.getInterface("register")
-----------------------------------------------------------------------------------------------------------------------------------------
-- VARS
-----------------------------------------------------------------------------------------------------------------------------------------
local registers = {
	{ 24.9,-1345.6,29.49,280.63 },
	{ 24.8,-1347.9,29.49,266.46 },
	{ 2555.5,381.24,108.61,0.0 },
	{ 2557.63,381.21,108.61,0.0 },
	{ 1165.07,-324.50,69.20,127.0 },
	{ 1164.67,-322.76,69.20,94.0 },
	{ -706.10,-915.43,19.21,116.0 },
	{ -706.16,-913.65,19.21,85.0 },
	{ -47.96,-1759.34,29.42,74.0 },
	{ -46.80,-1757.94,29.42,45.0 },
	{ 372.85,325.88,103.56,255.12 },
	{ 373.35,327.87,103.56,255.12 },
	{ -3241.74,1000.37,12.82,2.84 },
	{ -3243.78,1000.54,12.82,0.0 },
	{ 1727.94,6414.65,35.03,246.62 },
	{ 1728.89,6416.55,35.03,249.45 },
	{ 548.64,2671.84,42.16,96.38 },
	{ 548.84,2669.68,42.16,110.56 },
	{ 1959.62,3741.5,32.33,311.82 },
	{ 1960.74,3739.75,32.33,308.98 },
	{ 2678.75,3279.5,55.23,334.49 },
	{ 2676.76,3280.59,55.23,331.66 },
	{ 1696.57,4923.95,42.06,353.0 },
	{ 1698.06,4922.96,42.06,323.0 },
	{ -1818.89,792.94,138.08,161.0 },
	{ -1820.12,794.16,138.08,129.0 },
	{ 1392.87,3606.39,34.98,195.0 },
	{ -2966.44,390.89,15.04,84.0 },
	{ -3040.74,584.37,7.9,14.18 },
	{ -3038.51,585.13,7.9,22.68 },
	{ 1134.25,-982.47,46.41,273.0 },
	{ 1165.93,2710.77,38.15,177.0 },
	{ -1486.29,-378.02,40.16,132.0 },
	{ -1221.99,-908.29,12.32,28.0 },
	{ 75.25,-1392.39,29.37,272.13 },
	{ 75.24,-1390.41,29.37,272.13 },
	{ 75.21,-1388.66,29.37,280.63 },
	{ 425.71,-806.82,29.49,93.55 },
	{ 425.77,-808.79,29.49,87.88 },
	{ 425.75,-810.54,29.49,90.71 },
	{ -822.05,-1073.22,11.32,218.27 },
	{ -820.33,-1072.21,11.32,209.77 },
	{ -818.75,-1071.25,11.32,206.93 },
	{ -1196.76,-778.56,17.32,39.69 },
	{ -1198.36,-779.85,17.32,354.34 },
	{ 4.54,6512.0,31.88,36.86 },
	{ 3.13,6510.61,31.88,45.36 },
	{ 1.9,6509.46,31.88,36.86 },
	{ 1694.1,4822.22,42.06,93.55 },
	{ 1694.46,4820.5,42.06,96.38 },
	{ 1694.66,4818.56,42.06,90.71 },
	{ 123.59,-211.01,54.56,229.61 },
	{ 122.87,-213.01,54.56,255.12 },
	{ 621.33,2754.1,42.09,93.55 },
	{ 621.43,2752.0,42.09,68.04 },
	{ 1197.14,2710.38,38.22,192.76 },
	{ 1199.04,2710.44,38.22,181.42 },
	{ 1201.03,2710.34,38.22,175.75 },
	{ -3172.66,1054.73,20.86,249.45 },
	{ -3171.91,1056.62,20.86,221.11 },
	{ -1101.17,2710.98,19.11,215.44 },
	{ -1099.67,2712.32,19.11,223.94 },
	{ -1098.47,2713.51,19.11,221.11 },
	{ -821.91,-183.32,37.56,213.0 },
	{ 134.39,-1707.83,29.29,136.0 },
	{ -1284.26,-1115.05,6.99,89.0 },
	{ 1930.56,3727.93,32.84,205.0 },
	{ 1211.52,-470.31,66.20,72.0 },
	{ -30.42,-151.77,57.07,336.0 },
	{ -277.76,6230.73,31.69,38.0 },
	{ 162.02,6642.49,31.69,235.28 },
	{ 160.41,6640.94,31.69,229.61 }
}
-----------------------------------------------------------------------------------------------------------------------------------------
-- THREADTARGET
-----------------------------------------------------------------------------------------------------------------------------------------
CreateThread(function()
	for Number,Register in pairs(registers) do
		exports["target"]:AddCircleZone("register:"..Number,vector3(Register[1],Register[2],Register[3]),1.0,{
			name = "register:"..Number,
			heading = Register[4]
		},{
			shop = Number,
			Distance = 1.0,
			options = {
				{
					event = "register:openSystem",
					label = "Roubar",
					tunnel = "shop"
				}
			}
		})
	end
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- REGISTER:OPENSYSTEM
-----------------------------------------------------------------------------------------------------------------------------------------
AddEventHandler("register:openSystem",function(shopId)
	if vSERVER.ApplyTimers(shopId) then
		local Ped = PlayerPedId()
		SetEntityHeading(Ped,registers[shopId][4])
		SetEntityCoords(Ped,registers[shopId][1],registers[shopId][2],registers[shopId][3] - 1,1,0,0,0)
		vRP.playAnim(false,{"oddjobs@shop_robbery@rob_till","loop"},true)

		if exports["taskbar"]:taskThree() then
			vSERVER.Payment()
		end
		vRP.removeObjects()
	end
end)